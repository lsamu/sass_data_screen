function g(e){return typeof e=="object"&&e!==null}function y(e,r){return e=g(e)?e:Object.create(null),new Proxy(e,{get(i,t,n){return Reflect.get(i,t,n)||Reflect.get(r,t,n)}})}function p(e,r){return r.reduce((i,t)=>i==null?void 0:i[t],e)}function S(e,r,i){return r.slice(0,-1).reduce((t,n)=>/^(__proto__)$/.test(n)?{}:t[n]=t[n]||{},e)[r[r.length-1]]=i,e}function _(e,r){return r.reduce((i,t)=>{const n=t.split(".");return S(i,n,p(e,n))},{})}function z(e={}){return function(r){const{options:{persist:i},store:t}=r;if(!i)return;const{storage:n=localStorage,beforeRestore:s=null,afterRestore:l=null,serializer:c={serialize:JSON.stringify,deserialize:JSON.parse},key:o=t.$id,paths:a=null}=y(i,e);s==null||s(r);try{const u=n.getItem(o);u&&t.$patch(c.deserialize(u))}catch{}l==null||l(r),t.$subscribe((u,f)=>{try{const d=Array.isArray(a)?_(f,a):f;n.setItem(o,c.serialize(d))}catch{}},{detached:!0})}}var h=z();export{h as p};
